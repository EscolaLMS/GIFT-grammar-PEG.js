"use strict";function peg$subclass(r,t){function e(){this.constructor=r}e.prototype=t.prototype,r.prototype=new e}function peg$SyntaxError(r,t,e,n){this.message=r,this.expected=t,this.found=e,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,peg$SyntaxError)}function peg$parse(l,r){var s={},t={GIFTQuestions:ve},e=ve,n=function(r){return r},u=he("Category"),c="$",o=se("$",!1),a="CATEGORY:",i=se("CATEGORY:",!1),f=function(r){return{type:"Category",title:r}},h=he("Description"),p=function(r,t){t={id:Ke,tags:Ve,type:"Description",title:r,stem:t,hasEmbeddedAnswers:!1};return rn(),Ve=Ke=null,t},d="{",g=se("{",!1),A="}",v=se("}",!1),m=function(r,t,e,n){var u=null!==n,c=t?t.text+(u?" ":""):"",t=t&&t.format||n&&n.format||"moodle",n=c+(u?"_____ "+n.text:""),u=function(r,t){switch(r.globalFeedback=t.globalFeedback,r.type){case"TF":r.isTrue=t.isTrue,r.incorrectFeedback=t.feedback[1],r.correctFeedback=t.feedback[2];break;case"MC":case"Numerical":case"Short":r.choices=t.choices;break;case"Matching":r.matchPairs=t.matchPairs}"MC"==r.type&&function(r){for(var t=!0,e=0;e<r.length;e++)t&=r[e].isCorrect;return t}(r.choices)&&(r.type="Short");return r.id=Ke,r.tags=Ve,r}(u={type:e.type,title:r,stem:{format:t,text:n},hasEmbeddedAnswers:u},e);return rn(),u},b=he("{= match1 -> Match1\n...}"),C=function(r,t){return{type:"Matching",matchPairs:r,globalFeedback:t}},x=he("matches"),y=function(r){return r},F=he("match"),w="=",E=se("=",!1),k="->",S=se("->",!1),T=function(r,t){return{subquestion:{format:null!==r?r.format:Xe,text:null!==r?r.text:""},subanswer:t}},$=he("{T} or {F} or {TRUE} or {FALSE}"),j=function(r,t,e){return{type:"TF",isTrue:r,feedback:t,globalFeedback:e}},M=function(r){return r},R="TRUE",N=se("TRUE",!1),_="T",L=se("T",!1),U=function(){return!0},q="FALSE",G=se("FALSE",!1),O="F",P=se("F",!1),D=function(){return!1},Q=he("{=correct choice ~incorrect choice ... }"),Y=function(r,t){return{type:"MC",choices:r,globalFeedback:t}},H=he("Choices"),I=function(r){return r},z=he("Choice"),B=/^[=~]/,J=fe(["=","~"],!1,!1),K=function(r,t){var e=r[2],n=r[4];return r={isCorrect:"="==r[0],weight:e,text:n,feedback:t}},V=he("(weight)"),W="%",X=se("%",!1),Z=/^[\-]/,rr=fe(["-"],!1,!1),tr=function(r){return parseFloat(r.join(""))},er=he("(percent)"),nr="100",ur=se("100",!1),cr=/^[0-9]/,or=fe([["0","9"]],!1,!1),ar=/^[.]/,ir=fe(["."],!1,!1),lr=le,sr=he("(feedback)"),fr="#",hr=se("#",!1),pr="###",dr=se("###",!1),gr=function(r){return r},Ar=he("Essay question { ... }"),vr="",mr=function(r){return{type:"Essay",globalFeedback:r}},br=he("Single short answer { ... }"),Cr=function(r,t,e){var n=[];return n.push({isCorrect:!0,text:r,feedback:t,weight:null}),{type:"Short",choices:n,globalFeedback:e}},xr=he("{#... }"),yr=function(r,t){return{type:"Numerical",choices:r,globalFeedback:t}},Fr=he("Numerical Answers"),wr=he("Multiple Numerical Choices"),Er=he("Numerical Choice"),kr=function(r,t){var e=r[0],n=r[1],u=r[2];return r={isCorrect:"="==e,weight:n,text:null!==u?u:{format:Xe,text:"*"},feedback:t}},Sr=he("Single numeric answer"),Tr=he("(number with range)"),$r=":",jr=se(":",!1),Mr=function(r,t){return{type:"range",number:r,range:t}},Rr=he("(number with high-low)"),Nr="..",_r=se("..",!1),Lr=function(r,t){return{type:"high-low",numberHigh:t,numberLow:r}},Ur=he("(number answer)"),qr=function(r){return{type:"simple",number:r}},Gr=he(":: Title ::"),Or="::",Pr=se("::",!1),Dr=function(r){return r.join("")},Qr=he("Question stem"),Yr=function(r){var t;return t=r.format,Xe=t,r},Hr=he("(blank lines separator)"),Ir=he("(blank lines)"),zr=he("blank line"),Br=he("(Title text)"),Jr=function(r){return r},Kr=he("(text character)"),Vr=he("format"),Wr="[",Xr=se("[",!1),Zr="html",rt=se("html",!1),tt="markdown",et=se("markdown",!1),nt="plain",ut=se("plain",!1),ct="moodle",ot=se("moodle",!1),at="]",it=se("]",!1),lt=function(r){return r},st=he("(escape character)"),ft="\\",ht=se("\\",!1),pt=he("escape sequence"),dt="~",gt=se("~",!1),At=function(r){return r},vt=he(""),mt={type:"any"},bt=le,Ct=he("(formatted text excluding '->'"),xt=function(r,t){return{format:null!==r?r:Xe,text:"html"!==r?Ze(t.join("").trim()):t.join("").replace(/\r\n/g,"\n")}},yt=he("(formatted text)"),Ft=he("(unformatted text)"),wt=function(r){return Ze(r.join("").trim())},Et=he("(category text)"),kt=function(r){return r.flat().join("")},St=function(r,t){return parseFloat(r.join("")+t)},Tt=".",$t=se(".",!1),jt=function(r){return"."+r.join("")},Mt="####",Rt=se("####",!1),Nt=function(r){return r},_t=he("(single line whitespace)"),Lt=he("(multiple line whitespace)"),Ut=" ",qt=se(" ",!1),Gt=function(){Ve=Ke=null},Ot=he("(comment)"),Pt="//",Dt=se("//",!1),Qt=/^[^\n\r]/,Yt=fe(["\n","\r"],!0,!1),Ht=function(r){return null},It=function(r){var t=r.join(""),r=t.match(/\[id:([^\x00-\x1F\x7F]+?)]/);r&&(Ke=r[1].trim().replace("\\]","]"));t.matchAll(/\[tag:([^\x00-\x1F\x7F]+?)]/g);return Array.from(t.matchAll(/\[tag:([^\x00-\x1F\x7F]+?)]/g),function(r){return r[1]}).forEach(function(r){(Ve=Ve||[]).push(r)}),null},zt=he("(space)"),Bt="\t",Jt=se("\t",!1),Kt=he("(end of line)"),Vt="\r\n",Wt=se("\r\n",!1),Xt="\n",Zt=se("\n",!1),re="\r",te=se("\r",!1),ee=function(){return"EOF"},ne=0,ue=0,ce=[{line:1,column:1}],oe=0,ae=[],ie=0;if("startRule"in(r=void 0!==r?r:{})){if(!(r.startRule in t))throw new Error("Can't start parsing from rule \""+r.startRule+'".');e=t[r.startRule]}function le(){return l.substring(ue,ne)}function se(r,t){return{type:"literal",text:r,ignoreCase:t}}function fe(r,t,e){return{type:"class",parts:r,inverted:t,ignoreCase:e}}function he(r){return{type:"other",description:r}}function pe(r){var t,e=ce[r];if(e)return e;for(t=r-1;!ce[t];)t--;for(e={line:(e=ce[t]).line,column:e.column};t<r;)10===l.charCodeAt(t)?(e.line++,e.column=1):e.column++,t++;return ce[r]=e}function de(r,t){var e=pe(r),n=pe(t);return{start:{offset:r,line:e.line,column:e.column},end:{offset:t,line:n.line,column:n.column}}}function ge(r){ne<oe||(oe<ne&&(oe=ne,ae=[]),ae.push(r))}function Ae(r,t,e){return new peg$SyntaxError(peg$SyntaxError.buildMessage(r,t),r,t,e)}function ve(){var r=ne,t=[],e=me();if((e=e===s&&(e=be())===s?Ce():e)!==s)for(;e!==s;)t.push(e),(e=me())===s&&(e=be())===s&&(e=Ce());else t=s;return r=t!==s&&(e=Qe())!==s&&Ye()!==s?(ue=r,t=n(t)):(ne=r,s)}function me(){var r,t,e,n;return ie++,r=ne,r=He()!==s&&Ye()!==s?(36===l.charCodeAt(ne)?(t=c,ne++):(t=s,0===ie&&ge(o)),t!==s?(l.substr(ne,9)===a?(e=a,ne+=9):(e=s,0===ie&&ge(i)),e!==s&&Qe()!==s&&(n=function(){var r,t,e,n,u;ie++,t=[],n=e=r=ne,ie++,u=Be(),ie--,n=u===s?void 0:(ne=n,s);e=n!==s?(l.length>ne?(u=l.charAt(ne),ne++):(u=s,0===ie&&ge(mt)),u!==s?n=[n,u]:(ne=e,s)):(ne=e,s);for(;e!==s;)t.push(e),n=e=ne,ie++,u=Be(),ie--,n=u===s?void 0:(ne=n,s),e=n!==s?(l.length>ne?(u=l.charAt(ne),ne++):(u=s,0===ie&&ge(mt)),u!==s?n=[n,u]:(ne=e,s)):(ne=e,s);r=t!==s?(e=ne,ie++,(n=Be())===s&&(n=Je()),ie--,e=n!==s?void(ne=e):s,e!==s?(ue=r,t=kt(t)):(ne=r,s)):(ne=r,s);ie--,r===s&&(t=s,0===ie&&ge(Et));return r}())!==s&&$e()!==s?(ue=r,f(n)):(ne=r,s)):(ne=r,s)):(ne=r,s),ie--,r===s&&(0===ie&&ge(u)),r}function be(){var r,t,e,n;if(ie++,r=ne,He()!==s)if(Ye()!==s){for(t=[],e=Ie();e!==s;)t.push(e),e=Ie();r=t!==s&&(e=(e=Se())===s?null:e)!==s&&Qe()!==s&&(n=Te())!==s&&$e()!==s?(ue=r,p(e,n)):(ne=r,s)}else ne=r,r=s;else ne=r,r=s;return ie--,r===s&&(0===ie&&ge(h)),r}function Ce(){var r,t,e,n,u,c,o,a=ne,i=He();if(i!==s)if(Ye()!==s){for(r=[],t=Ie();t!==s;)r.push(t),t=Ie();a=r!==s&&(t=(t=Se())===s?null:t)!==s&&Qe()!==s&&(e=(e=Te())===s?null:e)!==s&&Qe()!==s?(123===l.charCodeAt(ne)?(n=d,ne++):(n=s,0===ie&&ge(g)),n!==s&&Qe()!==s&&(u=(u=function(){var r,t,e;ie++,r=ne,r=(t=function(){var r,t,e;if(ie++,r=ne,t=[],(e=xe())!==s)for(;e!==s;)t.push(e),e=xe();else t=s;t!==s&&(ue=r,t=y(t));ie--,(r=t)===s&&(t=s,0===ie&&ge(x));return r}())!==s?(e=Qe(),e!==s?(e=(e=De())===s?null:e)!==s?Qe()!==s?(ue=r,t=C(t,e)):(ne=r,s):(ne=r,s):(ne=r,s)):(ne=r,s);ie--,r===s&&(t=s,0===ie&&ge(b));return r}())===s&&(u=function(){var r,t,e,n,u,c;ie++,r=ne,r=(t=function(){var r,t;r=ne,(t=function(){var r,t;r=ne,l.substr(ne,4)===R?(t=R,ne+=4):(t=s,0===ie&&ge(N));t===s&&(84===l.charCodeAt(ne)?(t=_,ne++):(t=s,0===ie&&ge(L)));t!==s&&(ue=r,t=U());return r=t}())===s&&(t=function(){var r,t;r=ne,l.substr(ne,5)===q?(t=q,ne+=5):(t=s,0===ie&&ge(G));t===s&&(70===l.charCodeAt(ne)?(t=O,ne++):(t=s,0===ie&&ge(P)));t!==s&&(ue=r,t=D());return r=t}());t!==s&&(ue=r,t=M(t));return r=t}())!==s?(c=Qe(),c!==s?(e=ne,n=Qe(),(e=n!==s?(u=(u=we())===s?null:u)!==s?(c=(c=we())===s?null:c)!==s?n=[n,u,c]:(ne=e,s):(ne=e,s):(ne=e,s))!==s?(n=Qe())!==s?(u=(u=De())===s?null:u)!==s?(ue=r,t=j(t,e,u)):(ne=r,s):(ne=r,s):(ne=r,s)):(ne=r,s)):(ne=r,s);ie--,r===s&&(t=s,0===ie&&ge($));return r}())===s&&(u=function(){var r,t,e;ie++,r=ne,r=(t=function(){var r,t,e;if(ie++,r=ne,t=[],(e=ye())!==s)for(;e!==s;)t.push(e),e=ye();else t=s;t!==s&&(ue=r,t=I(t));ie--,(r=t)===s&&(t=s,0===ie&&ge(H));return r}())!==s?(e=Qe(),e!==s?(e=(e=De())===s?null:e)!==s?Qe()!==s?(ue=r,t=Y(t,e)):(ne=r,s):(ne=r,s):(ne=r,s)):(ne=r,s);ie--,r===s&&(t=s,0===ie&&ge(Q));return r}())===s&&(u=function(){var r,t,e,n;ie++,r=ne,35===l.charCodeAt(ne)?(t=fr,ne++):(t=s,0===ie&&ge(hr));r=t!==s?(n=Qe(),n!==s?(e=function(){var r;ie++,(r=function(){var r,t,e;if(ie++,r=ne,t=[],(e=Ee())!==s)for(;e!==s;)t.push(e),e=Ee();else t=s;t!==s&&(ue=r,t=I(t));ie--,(r=t)===s&&(t=s,0===ie&&ge(wr));return r}())===s&&(r=ke());ie--,r===s&&(0===ie&&ge(Fr));return r}())!==s?Qe()!==s?(n=(n=De())===s?null:n)!==s?(ue=r,t=yr(e,n)):(ne=r,s):(ne=r,s):(ne=r,s):(ne=r,s)):(ne=r,s);ie--,r===s&&(t=s,0===ie&&ge(xr));return r}())===s&&(u=function(){var r,t,e,n;ie++,r=ne,r=(t=Oe())!==s?(n=Qe(),n!==s?(e=(e=we())===s?null:e)!==s?Qe()!==s?(n=(n=De())===s?null:n)!==s?Qe()!==s?(ue=r,t=Cr(t,e,n)):(ne=r,s):(ne=r,s):(ne=r,s):(ne=r,s):(ne=r,s)):(ne=r,s);ie--,r===s&&(t=s,0===ie&&ge(br));return r}())===s?function(){var r,t;ie++,r=ne,r=vr!==s?(t=Qe(),t!==s?(t=(t=De())===s?null:t)!==s?Qe()!==s?(ue=r,mr(t)):(ne=r,s):(ne=r,s):(ne=r,s)):(ne=r,s);ie--,r===s&&(0===ie&&ge(Ar));return r}():u)!==s&&Qe()!==s?(125===l.charCodeAt(ne)?(c=A,ne++):(c=s,0===ie&&ge(v)),c!==s&&Qe()!==s&&(o=(o=(o=function(){var r,t,e,n;ie++,r=ne,l.substr(ne,2)===Pt?(t=Pt,ne+=2):(t=s,0===ie&&ge(Dt));if(t!==s){for(e=[],Qt.test(l.charAt(ne))?(n=l.charAt(ne),ne++):(n=s,0===ie&&ge(Yt));n!==s;)e.push(n),Qt.test(l.charAt(ne))?(n=l.charAt(ne),ne++):(n=s,0===ie&&ge(Yt));r=e!==s?(ue=r,t=Ht(e)):(ne=r,s)}else ne=r,r=s;ie--,r===s&&(t=s,0===ie&&ge(Ot));return r}())===s?Te():o)===s?null:o)!==s&&$e()!==s?(ue=a,m(t,e,u,o)):(ne=a,s)):(ne=a,s)):(ne=a,s)}else ne=a,a=s;else ne=a,a=s;return a}function xe(){var r,t,e,n,u;return ie++,r=ne,r=Qe()!==s?(61===l.charCodeAt(ne)?(t=w,ne++):(t=s,0===ie&&ge(E)),t!==s&&Qe()!==s&&(e=(e=function(){var r,t,e,n;ie++,r=ne,(t=_e())===s&&(t=null);if(t!==s)if(Qe()!==s){if(e=[],(n=Ne())!==s)for(;n!==s;)e.push(n),n=Ne();else e=s;r=e!==s?(ue=r,t=xt(t,e)):(ne=r,s)}else ne=r,r=s;else ne=r,r=s;ie--,r===s&&(t=s,0===ie&&ge(Ct));return r}())===s?null:e)!==s&&Qe()!==s?(l.substr(ne,2)===k?(n=k,ne+=2):(n=s,0===ie&&ge(S)),n!==s&&Qe()!==s&&(u=function(){var r,t,e;if(ie++,r=ne,t=[],(e=Re())!==s)for(;e!==s;)t.push(e),e=Re();else t=s;t!==s&&(ue=r,t=wt(t));ie--,(r=t)===s&&(t=s,0===ie&&ge(Ft));return r}())!==s&&Qe()!==s?(ue=r,T(e,u)):(ne=r,s)):(ne=r,s)):(ne=r,s),ie--,r===s&&(0===ie&&ge(F)),r}function ye(){var r,t,e,n,u,c,o;return ie++,r=ne,r=Qe()!==s?(B.test(l.charAt(t=ne))?(e=l.charAt(ne),ne++):(e=s,0===ie&&ge(J)),(t=e!==s&&(n=Qe())!==s&&(u=(u=Fe())===s?null:u)!==s&&(c=Qe())!==s&&(o=Oe())!==s?e=[e,n,u,c,o]:(ne=t,s))!==s&&(e=(e=we())===s?null:e)!==s&&(n=Qe())!==s?(ue=r,K(t,e)):(ne=r,s)):(ne=r,s),ie--,r===s&&(0===ie&&ge(z)),r}function Fe(){var r,t,e,n,u;return ie++,37===l.charCodeAt(r=ne)?(t=W,ne++):(t=s,0===ie&&ge(X)),r=t!==s?(Z.test(l.charAt(e=ne))?(n=l.charAt(ne),ne++):(n=s,0===ie&&ge(rr)),(e=(n=n===s?null:n)!==s&&(u=function(){var r,t,e,n,u,c;ie++,l.substr(ne,3)===nr?(r=nr,ne+=3):(r=s,0===ie&&ge(ur));if(r===s)if(r=ne,cr.test(l.charAt(ne))?(t=l.charAt(ne),ne++):(t=s,0===ie&&ge(or)),t!==s)if(cr.test(l.charAt(ne))?(e=l.charAt(ne),ne++):(e=s,0===ie&&ge(or)),(e=e===s?null:e)!==s)if(ar.test(l.charAt(ne))?(n=l.charAt(ne),ne++):(n=s,0===ie&&ge(ir)),(n=n===s?null:n)!==s){for(u=[],cr.test(l.charAt(ne))?(c=l.charAt(ne),ne++):(c=s,0===ie&&ge(or));c!==s;)u.push(c),cr.test(l.charAt(ne))?(c=l.charAt(ne),ne++):(c=s,0===ie&&ge(or));r=u!==s?(ue=r,t=lr()):(ne=r,s)}else ne=r,r=s;else ne=r,r=s;else ne=r,r=s;ie--,r===s&&(t=s,0===ie&&ge(er));return r}())!==s?n=[n,u]:(ne=e,s))!==s?(37===l.charCodeAt(ne)?(n=W,ne++):(n=s,0===ie&&ge(X)),n!==s?(ue=r,t=tr(e)):(ne=r,s)):(ne=r,s)):(ne=r,s),ie--,r===s&&(t=s,0===ie&&ge(V)),r}function we(){var r,t,e,n,u;return ie++,35===l.charCodeAt(r=ne)?(t=fr,ne++):(t=s,0===ie&&ge(hr)),r=t!==s?(ie++,l.substr(e=ne,3)===pr?(n=pr,ne+=3):(n=s,0===ie&&ge(dr)),ie--,(e=n===s?void 0:(ne=e,s))!==s&&(n=Qe())!==s&&(u=(u=Oe())===s?null:u)!==s?(ue=r,t=gr(u)):(ne=r,s)):(ne=r,s),ie--,r===s&&(t=s,0===ie&&ge(sr)),r}function Ee(){var r,t,e,n,u;return ie++,r=ne,r=Qe()!==s?(B.test(l.charAt(t=ne))?(e=l.charAt(ne),ne++):(e=s,0===ie&&ge(J)),(t=e!==s&&(n=(n=Fe())===s?null:n)!==s&&(u=(u=ke())===s?null:u)!==s?e=[e,n,u]:(ne=t,s))!==s&&(e=Qe())!==s&&(n=(n=we())===s?null:n)!==s&&(u=Qe())!==s?(ue=r,kr(t,n)):(ne=r,s)):(ne=r,s),ie--,r===s&&(0===ie&&ge(Er)),r}function ke(){var r;return ie++,(r=function(){var r,t,e;ie++,r=ne,r=(t=Pe())!==s?(58===l.charCodeAt(ne)?(e=$r,ne++):(e=s,0===ie&&ge(jr)),e!==s?(e=Pe())!==s?(ue=r,t=Mr(t,e)):(ne=r,s):(ne=r,s)):(ne=r,s);ie--,r===s&&(t=s,0===ie&&ge(Tr));return r}())===s&&(r=function(){var r,t,e;ie++,r=ne,r=(t=Pe())!==s?(l.substr(ne,2)===Nr?(e=Nr,ne+=2):(e=s,0===ie&&ge(_r)),e!==s?(e=Pe())!==s?(ue=r,t=Lr(t,e)):(ne=r,s):(ne=r,s)):(ne=r,s);ie--,r===s&&(t=s,0===ie&&ge(Rr));return r}())===s&&(r=function(){var r,t;ie++,r=ne,(t=Pe())!==s&&(ue=r,t=qr(t));ie--,(r=t)===s&&(t=s,0===ie&&ge(Ur));return r}()),ie--,r===s&&(0===ie&&ge(Sr)),r}function Se(){var r,t,e,n;if(ie++,l.substr(r=ne,2)===Or?(t=Or,ne+=2):(t=s,0===ie&&ge(Pr)),t!==s){if(e=[],(n=Me())!==s)for(;n!==s;)e.push(n),n=Me();else e=s;r=e!==s?(l.substr(ne,2)===Or?(n=Or,ne+=2):(n=s,0===ie&&ge(Pr)),n!==s?(ue=r,t=Dr(e)):(ne=r,s)):(ne=r,s)}else ne=r,r=s;return ie--,r===s&&(t=s,0===ie&&ge(Gr)),r}function Te(){var r,t;return ie++,r=ne,(t=Oe())!==s&&(ue=r,t=Yr(t)),ie--,(r=t)===s&&(t=s,0===ie&&ge(Qr)),r}function $e(){var r,t,e;return ie++,(r=function(){var r,t,e,n;if(ie++,r=ne,(t=Be())!==s){if(e=[],(n=je())!==s)for(;n!==s;)e.push(n),n=je();else e=s;r=e!==s?t=[t,e]:(ne=r,s)}else ne=r,r=s;ie--,r===s&&(t=s,0===ie&&ge(Ir));return r}())===s&&(r=ne,r=(t=(t=Be())===s?null:t)!==s&&(e=Je())!==s?t=[t,e]:(ne=r,s)),ie--,r===s&&(t=s,0===ie&&ge(Hr)),r}function je(){var r,t,e;for(ie++,r=ne,t=[],e=ze();e!==s;)t.push(e),e=ze();return r=t!==s&&(e=Be())!==s?t=[t,e]:(ne=r,s),ie--,r===s&&(t=s,0===ie&&ge(zr)),r}function Me(){var r,t,e;return ie++,ie++,l.substr(t=r=ne,2)===Or?(e=Or,ne+=2):(e=s,0===ie&&ge(Pr)),ie--,r=(t=e===s?void 0:(ne=t,s))!==s&&(e=(e=Ue())===s?qe():e)!==s?(ue=r,t=Jr(e)):(ne=r,s),ie--,r===s&&(t=s,0===ie&&ge(Br)),r}function Re(){var r;return ie++,(r=qe())===s&&(r=Ue())===s&&(r=Le()),ie--,r===s&&(0===ie&&ge(Kr)),r}function Ne(){var r;return ie++,(r=function(){var r,t,e;ie++,t=r=ne,ie++,(e=Ue())!==s||(e=Ge())===s&&(l.substr(ne,2)===k?(e=k,ne+=2):(e=s,0===ie&&ge(S)),e===s&&(e=$e()));ie--,t=e===s?void 0:(ne=t,s);r=t!==s?(l.length>ne?(e=l.charAt(ne),ne++):(e=s,0===ie&&ge(mt)),e!==s?(ue=r,t=bt()):(ne=r,s)):(ne=r,s);ie--,r===s&&(t=s,0===ie&&ge(vt));return r}())===s&&(r=Ue())===s&&(r=Le()),ie--,r===s&&(0===ie&&ge(Kr)),r}function _e(){var r,t,e,n;return ie++,91===l.charCodeAt(r=ne)?(t=Wr,ne++):(t=s,0===ie&&ge(Xr)),r=t!==s?(l.substr(ne,4)===Zr?(e=Zr,ne+=4):(e=s,0===ie&&ge(rt)),e===s&&(l.substr(ne,8)===tt?(e=tt,ne+=8):(e=s,0===ie&&ge(et)),e===s&&(l.substr(ne,5)===nt?(e=nt,ne+=5):(e=s,0===ie&&ge(ut)),e===s&&(l.substr(ne,6)===ct?(e=ct,ne+=6):(e=s,0===ie&&ge(ot))))),e!==s?(93===l.charCodeAt(ne)?(n=at,ne++):(n=s,0===ie&&ge(it)),n!==s?(ue=r,t=lt(e)):(ne=r,s)):(ne=r,s)):(ne=r,s),ie--,r===s&&(t=s,0===ie&&ge(Vr)),r}function Le(){var r;return ie++,92===l.charCodeAt(ne)?(r=ft,ne++):(r=s,0===ie&&ge(ht)),ie--,r===s&&(0===ie&&ge(st)),r}function Ue(){var r,t;return ie++,r=ne,r=Le()!==s?((t=Le())===s&&(58===l.charCodeAt(ne)?(t=$r,ne++):(t=s,0===ie&&ge(jr)),t===s&&(126===l.charCodeAt(ne)?(t=dt,ne++):(t=s,0===ie&&ge(gt)),t===s&&(61===l.charCodeAt(ne)?(t=w,ne++):(t=s,0===ie&&ge(E)),t===s&&(35===l.charCodeAt(ne)?(t=fr,ne++):(t=s,0===ie&&ge(hr)),t===s&&(91===l.charCodeAt(ne)?(t=Wr,ne++):(t=s,0===ie&&ge(Xr)),t===s&&(93===l.charCodeAt(ne)?(t=at,ne++):(t=s,0===ie&&ge(it)),t===s&&(123===l.charCodeAt(ne)?(t=d,ne++):(t=s,0===ie&&ge(g)),t===s&&(125===l.charCodeAt(ne)?(t=A,ne++):(t=s,0===ie&&ge(v)))))))))),t!==s?(ue=r,At(t)):(ne=r,s)):(ne=r,s),ie--,r===s&&(0===ie&&ge(pt)),r}function qe(){var r,t,e;return ie++,t=r=ne,ie++,(e=Ue())===s&&(e=Ge())===s&&(e=$e()),ie--,r=(t=e===s?void 0:(ne=t,s))!==s?(l.length>ne?(e=l.charAt(ne),ne++):(e=s,0===ie&&ge(mt)),e!==s?(ue=r,t=bt()):(ne=r,s)):(ne=r,s),ie--,r===s&&(t=s,0===ie&&ge(vt)),r}function Ge(){var r;return 61===l.charCodeAt(ne)?(r=w,ne++):(r=s,0===ie&&ge(E)),r===s&&(126===l.charCodeAt(ne)?(r=dt,ne++):(r=s,0===ie&&ge(gt)),r===s&&(35===l.charCodeAt(ne)?(r=fr,ne++):(r=s,0===ie&&ge(hr)),r===s&&(123===l.charCodeAt(ne)?(r=d,ne++):(r=s,0===ie&&ge(g)),r===s&&(125===l.charCodeAt(ne)?(r=A,ne++):(r=s,0===ie&&ge(v)),r===s&&(92===l.charCodeAt(ne)?(r=ft,ne++):(r=s,0===ie&&ge(ht)),r===s&&(58===l.charCodeAt(ne)?(r=$r,ne++):(r=s,0===ie&&ge(jr)))))))),r}function Oe(){var r,t,e,n;if(ie++,r=ne,(t=(t=_e())===s?null:t)!==s)if(Qe()!==s){if(e=[],(n=Re())!==s)for(;n!==s;)e.push(n),n=Re();else e=s;r=e!==s?(ue=r,t=xt(t,e)):(ne=r,s)}else ne=r,r=s;else ne=r,r=s;return ie--,r===s&&(t=s,0===ie&&ge(yt)),r}function Pe(){var r,t=ne,e=[];if(cr.test(l.charAt(ne))?(r=l.charAt(ne),ne++):(r=s,0===ie&&ge(or)),r!==s)for(;r!==s;)e.push(r),cr.test(l.charAt(ne))?(r=l.charAt(ne),ne++):(r=s,0===ie&&ge(or));else e=s;return t=e!==s&&(r=(r=function(){var r,t,e,n,u;r=ne,46===l.charCodeAt(ne)?(t=Tt,ne++):(t=s,0===ie&&ge($t));if(t!==s)if(e=ne,ie++,46===l.charCodeAt(ne)?(n=Tt,ne++):(n=s,0===ie&&ge($t)),ie--,(e=n===s?void 0:(ne=e,s))!==s){for(n=[],cr.test(l.charAt(ne))?(u=l.charAt(ne),ne++):(u=s,0===ie&&ge(or));u!==s;)n.push(u),cr.test(l.charAt(ne))?(u=l.charAt(ne),ne++):(u=s,0===ie&&ge(or));r=n!==s?(ue=r,t=jt(n)):(ne=r,s)}else ne=r,r=s;else ne=r,r=s;return r}())===s?null:r)!==s?(ue=t,e=St(e,r)):(ne=t,s)}function De(){var r,t,e=ne;return l.substr(ne,4)===Mt?(r=Mt,ne+=4):(r=s,0===ie&&ge(Rt)),e=r!==s&&Qe()!==s&&(t=Oe())!==s&&Qe()!==s?(ue=e,r=Nt(t)):(ne=e,s)}function Qe(){var r,t,e,n,u;for(ie++,r=[],(t=ze())===s&&(t=ne,t=(e=Be())!==s?(n=ne,ie++,u=je(),ie--,(n=u===s?void 0:(ne=n,s))!==s?e=[e,n]:(ne=t,s)):(ne=t,s));t!==s;)r.push(t),(t=ze())===s&&(t=ne,t=(e=Be())!==s?(n=ne,ie++,u=je(),ie--,(n=u===s?void 0:(ne=n,s))!==s?e=[e,n]:(ne=t,s)):(ne=t,s));return ie--,r===s&&(t=s,0===ie&&ge(_t)),r}function Ye(){var r,t;for(ie++,r=[],(t=Ie())===s&&(t=Be())===s&&(t=ze());t!==s;)r.push(t),(t=Ie())===s&&(t=Be())===s&&(t=ze());return ie--,r===s&&(t=s,0===ie&&ge(Lt)),r}function He(){var r,t,e=ne,n=ne;for(ie++,r=[],32===l.charCodeAt(ne)?(t=Ut,ne++):(t=s,0===ie&&ge(qt));t!==s;)r.push(t),32===l.charCodeAt(ne)?(t=Ut,ne++):(t=s,0===ie&&ge(qt));return ie--,(n=r!==s?void(ne=n):s)!==s&&(ue=e,n=Gt()),e=n}function Ie(){var r,t,e,n;if(ie++,l.substr(r=ne,2)===Pt?(t=Pt,ne+=2):(t=s,0===ie&&ge(Dt)),t!==s){for(e=[],Qt.test(l.charAt(ne))?(n=l.charAt(ne),ne++):(n=s,0===ie&&ge(Yt));n!==s;)e.push(n),Qt.test(l.charAt(ne))?(n=l.charAt(ne),ne++):(n=s,0===ie&&ge(Yt));r=e!==s?(ue=r,t=It(e)):(ne=r,s)}else ne=r,r=s;return ie--,r===s&&(t=s,0===ie&&ge(Ot)),r}function ze(){var r;return ie++,32===l.charCodeAt(ne)?(r=Ut,ne++):(r=s,0===ie&&ge(qt)),r===s&&(9===l.charCodeAt(ne)?(r=Bt,ne++):(r=s,0===ie&&ge(Jt))),ie--,r===s&&(0===ie&&ge(zt)),r}function Be(){var r;return ie++,l.substr(ne,2)===Vt?(r=Vt,ne+=2):(r=s,0===ie&&ge(Wt)),r===s&&(10===l.charCodeAt(ne)?(r=Xt,ne++):(r=s,0===ie&&ge(Zt)),r===s&&(13===l.charCodeAt(ne)?(r=re,ne++):(r=s,0===ie&&ge(te)))),ie--,r===s&&(0===ie&&ge(Kt)),r}function Je(){var r,t=ne,e=ne;return ie++,l.length>ne?(r=l.charAt(ne),ne++):(r=s,0===ie&&ge(mt)),ie--,(e=r===s?void 0:(ne=e,s))!==s&&(ue=t,e=ee()),t=e}var Ke=null,Ve=null,We="moodle",Xe=We;function Ze(r){return(r=r.replace(/[\n\r]/g," ")).replace(/\s\s+/g," ")}function rn(){Xe=We}if((e=e())!==s&&ne===l.length)return e;throw e!==s&&ne<l.length&&ge({type:"end"}),Ae(ae,oe<l.length?l.charAt(oe):null,oe<l.length?de(oe,oe+1):de(oe,oe))}peg$subclass(peg$SyntaxError,Error),peg$SyntaxError.buildMessage=function(r,t){var e,c={literal:function(r){return'"'+u(r.text)+'"'},class:function(r){for(var t="",e=0;e<r.parts.length;e++)t+=r.parts[e]instanceof Array?o(r.parts[e][0])+"-"+o(r.parts[e][1]):o(r.parts[e]);return"["+(r.inverted?"^":"")+t+"]"},any:function(r){return"any character"},end:function(r){return"end of input"},other:function(r){return r.description}};function n(r){return r.charCodeAt(0).toString(16).toUpperCase()}function u(r){return r.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(r){return"\\x0"+n(r)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(r){return"\\x"+n(r)})}function o(r){return r.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(r){return"\\x0"+n(r)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(r){return"\\x"+n(r)})}return"Expected "+function(r){for(var t,e,n=new Array(r.length),u=0;u<r.length;u++)n[u]=(e=r[u],c[e.type](e));if(n.sort(),0<n.length){for(t=u=1;u<n.length;u++)n[u-1]!==n[u]&&(n[t]=n[u],t++);n.length=t}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(r)+" but "+((e=t)?'"'+u(e)+'"':"end of input")+" found."},module.exports={SyntaxError:peg$SyntaxError,parse:peg$parse};
