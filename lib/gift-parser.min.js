"use strict";function peg$subclass(r,t){function e(){this.constructor=r}e.prototype=t.prototype,r.prototype=new e}function peg$SyntaxError(r,t,e,n){this.message=r,this.expected=t,this.found=e,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,peg$SyntaxError)}function peg$parse(r,t){t=void 0!==t?t:{};var e,n={},a={GIFTQuestions:mt},u=mt,o=pt("Category"),c=ft("$",!1),i="CATEGORY:",l=ft("CATEGORY:",!1),s=pt("Description"),f=ft("{",!1),h=ft("}",!1),p=function(r,t,e,n){var a=null!==n,u=t?t.text+(a?" ":""):"",o=t&&t.format||n&&n.format||"moodle",c=u+(a?"_____ "+n.text:""),i={type:e.type,title:r,stem:{format:o,text:c},hasEmbeddedAnswers:a};return i=function(r,t){switch(r.globalFeedback=t.globalFeedback,r.type){case"TF":r.isTrue=t.isTrue,r.incorrectFeedback=t.feedback[1],r.correctFeedback=t.feedback[2];break;case"MC":case"Numerical":case"Short":r.choices=t.choices;break;case"Matching":r.matchPairs=t.matchPairs}"MC"==r.type&&function(r){for(var t=!0,e=0;e<r.length;e++)t&=r[e].isCorrect;return t}(r.choices)&&(r.type="Short");return r.id=Vt,r.tags=Wt,r}(i,e),ee(),i},d=pt("{= match1 -> Match1\n...}"),g=pt("matches"),A=pt("match"),v=ft("=",!1),m="->",b=ft("->",!1),C=pt("{T} or {F} or {TRUE} or {FALSE}"),x="TRUE",y=ft("TRUE",!1),F=ft("T",!1),w="FALSE",E=ft("FALSE",!1),k=ft("F",!1),S=pt("{=correct choice ~incorrect choice ... }"),T=pt("Choices"),$=pt("Choice"),j=/^[=~]/,M=ht(["=","~"],!1,!1),R=pt("(weight)"),N=ft("%",!1),_=/^[\-]/,L=ht(["-"],!1,!1),U=pt("(percent)"),q="100",G=ft("100",!1),O=/^[0-9]/,P=ht([["0","9"]],!1,!1),D=/^[.]/,Q=ht(["."],!1,!1),Y=pt("(feedback)"),H="#",I=ft("#",!1),z=ft("###",!1),B=pt("Essay question { ... }"),J=pt("Single short answer { ... }"),K=pt("{#... }"),V=pt("Numerical Answers"),W=pt("Multiple Numerical Choices"),X=pt("Numerical Choice"),Z=pt("Single numeric answer"),rr=pt("(number with range)"),tr=":",er=ft(":",!1),nr=pt("(number with high-low)"),ar="..",ur=ft("..",!1),or=pt("(number answer)"),cr=pt(":: Title ::"),ir="::",lr=ft("::",!1),sr=pt("Question stem"),fr=function(r){var t;return t=r.format,Zt=t,r},hr=pt("(blank lines separator)"),pr=pt("(blank lines)"),dr=pt("blank line"),gr=pt("(Title text)"),Ar=pt("(text character)"),vr=pt("format"),mr=ft("[",!1),br="html",Cr=ft("html",!1),xr="markdown",yr=ft("markdown",!1),Fr="plain",wr=ft("plain",!1),Er="moodle",kr=ft("moodle",!1),Sr=ft("]",!1),Tr=pt("(escape character)"),$r=ft("\\",!1),jr=pt("escape sequence"),Mr=ft("~",!1),Rr=pt(""),Nr={type:"any"},_r=function(){return st()},Lr=pt("(formatted text excluding '->'"),Ur=function(r,t){return{format:null!==r?r:te(),text:"html"!==r?re(t.join("")):t.join("").replace(/\r\n/g,"\n")}},qr=pt("(formatted text)"),Gr=pt("(unformatted text)"),Or=pt("(category text)"),Pr=".",Dr=ft(".",!1),Qr="####",Yr=ft("####",!1),Hr=pt("(single line whitespace)"),Ir=pt("(multiple line whitespace)"),zr=ft(" ",!1),Br=pt("(comment)"),Jr="//",Kr=ft("//",!1),Vr=/^[^\n\r]/,Wr=ht(["\n","\r"],!0,!1),Xr=pt("(space)"),Zr=ft("\t",!1),rt=pt("(end of line)"),tt=ft("\r\n",!1),et=ft("\n",!1),nt=ft("\r",!1),at=0,ut=0,ot=[{line:1,column:1}],ct=0,it=[],lt=0;if("startRule"in t){if(!(t.startRule in a))throw new Error("Can't start parsing from rule \""+t.startRule+'".');u=a[t.startRule]}function st(){return r.substring(ut,at)}function ft(r,t){return{type:"literal",text:r,ignoreCase:t}}function ht(r,t,e){return{type:"class",parts:r,inverted:t,ignoreCase:e}}function pt(r){return{type:"other",description:r}}function dt(t){var e,n=ot[t];if(n)return n;for(e=t-1;!ot[e];)e--;for(n={line:(n=ot[e]).line,column:n.column};e<t;)10===r.charCodeAt(e)?(n.line++,n.column=1):n.column++,e++;return ot[t]=n,n}function gt(r,t){var e=dt(r),n=dt(t);return{start:{offset:r,line:e.line,column:e.column},end:{offset:t,line:n.line,column:n.column}}}function At(r){at<ct||(at>ct&&(ct=at,it=[]),it.push(r))}function vt(r,t,e){return new peg$SyntaxError(peg$SyntaxError.buildMessage(r,t),r,t,e)}function mt(){var r,t,e;if(r=at,t=[],(e=bt())===n&&(e=Ct())===n&&(e=xt()),e!==n)for(;e!==n;)t.push(e),(e=bt())===n&&(e=Ct())===n&&(e=xt());else t=n;return t!==n&&(e=Yt())!==n&&Ht()!==n?(ut=r,r=t=t):(at=r,r=n),r}function bt(){var t,e,a,u;return lt++,t=at,It()!==n&&Ht()!==n?(36===r.charCodeAt(at)?(e="$",at++):(e=n,0===lt&&At(c)),e!==n?(r.substr(at,9)===i?(a=i,at+=9):(a=n,0===lt&&At(l)),a!==n&&Yt()!==n?(u=function(){var t,e,a,u,o;lt++,t=at,e=[],a=at,u=at,lt++,o=Jt(),lt--,o===n?u=void 0:(at=u,u=n);u!==n?(r.length>at?(o=r.charAt(at),at++):(o=n,0===lt&&At(Nr)),o!==n?a=u=[u,o]:(at=a,a=n)):(at=a,a=n);for(;a!==n;)e.push(a),a=at,u=at,lt++,o=Jt(),lt--,o===n?u=void 0:(at=u,u=n),u!==n?(r.length>at?(o=r.charAt(at),at++):(o=n,0===lt&&At(Nr)),o!==n?a=u=[u,o]:(at=a,a=n)):(at=a,a=n);e!==n?(a=at,lt++,(u=Jt())===n&&(u=Kt()),lt--,u!==n?(at=a,a=void 0):a=n,a!==n?(ut=t,t=e=e.flat().join("")):(at=t,t=n)):(at=t,t=n);lt--,t===n&&(e=n,0===lt&&At(Or));return t}(),u!==n&&jt()!==n?(ut=t,t={type:"Category",title:u}):(at=t,t=n)):(at=t,t=n)):(at=t,t=n)):(at=t,t=n),lt--,t===n&&(n,0===lt&&At(o)),t}function Ct(){var r,t,e,a,u;if(lt++,r=at,(t=It())!==n)if(Ht()!==n){for(e=[],a=zt();a!==n;)e.push(a),a=zt();e!==n?((a=Tt())===n&&(a=null),a!==n&&Yt()!==n&&(u=$t())!==n&&jt()!==n?(ut=r,t=function(r,t){var e={id:Vt,tags:Wt,type:"Description",title:r,stem:t,hasEmbeddedAnswers:!1};return ee(),Vt=null,Wt=null,e}(a,u),r=t):(at=r,r=n)):(at=r,r=n)}else at=r,r=n;else at=r,r=n;return lt--,r===n&&(t=n,0===lt&&At(s)),r}function xt(){var t,e,a,u,o,c,i,l;if(t=at,It()!==n)if(Ht()!==n){for(e=[],a=zt();a!==n;)e.push(a),a=zt();e!==n?((a=Tt())===n&&(a=null),a!==n&&Yt()!==n?((u=$t())===n&&(u=null),u!==n&&Yt()!==n?(123===r.charCodeAt(at)?(o="{",at++):(o=n,0===lt&&At(f)),o!==n&&Yt()!==n?(c=function(){var r,t,e;lt++,r=at,t=function(){var r,t,e;if(lt++,r=at,t=[],(e=yt())!==n)for(;e!==n;)t.push(e),e=yt();else t=n;t!==n&&(ut=r,t=t);lt--,(r=t)===n&&(t=n,0===lt&&At(g));return r}(),t!==n&&Yt()!==n?((e=Qt())===n&&(e=null),e!==n&&Yt()!==n?(ut=r,r=t={type:"Matching",matchPairs:t,globalFeedback:e}):(at=r,r=n)):(at=r,r=n);lt--,r===n&&(t=n,0===lt&&At(d));return r}(),c===n&&(c=function(){var t,e,a,u,o,c;lt++,t=at,e=function(){var t,e;t=at,e=function(){var t,e;t=at,r.substr(at,4)===x?(e=x,at+=4):(e=n,0===lt&&At(y));e===n&&(84===r.charCodeAt(at)?(e="T",at++):(e=n,0===lt&&At(F)));e!==n&&(ut=t,e=!0);return t=e}(),e===n&&(e=function(){var t,e;t=at,r.substr(at,5)===w?(e=w,at+=5):(e=n,0===lt&&At(E));e===n&&(70===r.charCodeAt(at)?(e="F",at++):(e=n,0===lt&&At(k)));e!==n&&(ut=t,e=!1);return t=e}());e!==n&&(ut=t,e=e);return t=e}(),e!==n&&Yt()!==n?(a=at,(u=Yt())!==n?((o=Et())===n&&(o=null),o!==n?((c=Et())===n&&(c=null),c!==n?a=u=[u,o,c]:(at=a,a=n)):(at=a,a=n)):(at=a,a=n),a!==n&&(u=Yt())!==n?((o=Qt())===n&&(o=null),o!==n?(ut=t,t=e={type:"TF",isTrue:e,feedback:a,globalFeedback:o}):(at=t,t=n)):(at=t,t=n)):(at=t,t=n);lt--,t===n&&(e=n,0===lt&&At(C));return t}(),c===n&&(c=function(){var r,t,e;lt++,r=at,t=function(){var r,t,e;if(lt++,r=at,t=[],(e=Ft())!==n)for(;e!==n;)t.push(e),e=Ft();else t=n;t!==n&&(ut=r,t=t);lt--,(r=t)===n&&(t=n,0===lt&&At(T));return r}(),t!==n&&Yt()!==n?((e=Qt())===n&&(e=null),e!==n&&Yt()!==n?(ut=r,r=t={type:"MC",choices:t,globalFeedback:e}):(at=r,r=n)):(at=r,r=n);lt--,r===n&&(t=n,0===lt&&At(S));return r}(),c===n&&(c=function(){var t,e,a,u;lt++,t=at,35===r.charCodeAt(at)?(e=H,at++):(e=n,0===lt&&At(I));e!==n&&Yt()!==n?(a=function(){var r;lt++,r=function(){var r,t,e;if(lt++,r=at,t=[],(e=kt())!==n)for(;e!==n;)t.push(e),e=kt();else t=n;t!==n&&(ut=r,t=t);lt--,(r=t)===n&&(t=n,0===lt&&At(W));return r}(),r===n&&(r=St());lt--,r===n&&(n,0===lt&&At(V));return r}(),a!==n&&Yt()!==n?((u=Qt())===n&&(u=null),u!==n?(ut=t,t=e={type:"Numerical",choices:a,globalFeedback:u}):(at=t,t=n)):(at=t,t=n)):(at=t,t=n);lt--,t===n&&(e=n,0===lt&&At(K));return t}(),c===n&&(c=function(){var r,t,e,a;lt++,r=at,(t=Pt())!==n&&Yt()!==n?((e=Et())===n&&(e=null),e!==n&&Yt()!==n?((a=Qt())===n&&(a=null),a!==n&&Yt()!==n?(ut=r,u=a,(o=[]).push({isCorrect:!0,text:t,feedback:e,weight:null}),r=t={type:"Short",choices:o,globalFeedback:u}):(at=r,r=n)):(at=r,r=n)):(at=r,r=n);var u,o;lt--,r===n&&(t=n,0===lt&&At(J));return r}(),c===n&&(c=function(){var r,t;lt++,r=at,""!==n&&Yt()!==n?((t=Qt())===n&&(t=null),t!==n&&Yt()!==n?(ut=r,r={type:"Essay",globalFeedback:t}):(at=r,r=n)):(at=r,r=n);lt--,r===n&&(n,0===lt&&At(B));return r}()))))),c!==n&&Yt()!==n?(125===r.charCodeAt(at)?(i="}",at++):(i=n,0===lt&&At(h)),i!==n&&Yt()!==n?(l=function(){var t,e,a,u;lt++,t=at,r.substr(at,2)===Jr?(e=Jr,at+=2):(e=n,0===lt&&At(Kr));if(e!==n){for(a=[],Vr.test(r.charAt(at))?(u=r.charAt(at),at++):(u=n,0===lt&&At(Wr));u!==n;)a.push(u),Vr.test(r.charAt(at))?(u=r.charAt(at),at++):(u=n,0===lt&&At(Wr));a!==n?(ut=t,t=e=null):(at=t,t=n)}else at=t,t=n;lt--,t===n&&(e=n,0===lt&&At(Br));return t}(),l===n&&(l=$t()),l===n&&(l=null),l!==n&&jt()!==n?(ut=t,t=p(a,u,c,l)):(at=t,t=n)):(at=t,t=n)):(at=t,t=n)):(at=t,t=n)):(at=t,t=n)):(at=t,t=n)):(at=t,t=n)}else at=t,t=n;else at=t,t=n;return t}function yt(){var t,e,a,u,o,c,i;return lt++,t=at,Yt()!==n?(61===r.charCodeAt(at)?(e="=",at++):(e=n,0===lt&&At(v)),e!==n&&Yt()!==n?(a=function(){var r,t,e,a;lt++,r=at,(t=Lt())===n&&(t=null);if(t!==n)if(Yt()!==n){if(e=[],(a=_t())!==n)for(;a!==n;)e.push(a),a=_t();else e=n;e!==n?(ut=r,r=t=Ur(t,e)):(at=r,r=n)}else at=r,r=n;else at=r,r=n;lt--,r===n&&(t=n,0===lt&&At(Lr));return r}(),a===n&&(a=null),a!==n&&Yt()!==n?(r.substr(at,2)===m?(u=m,at+=2):(u=n,0===lt&&At(b)),u!==n&&Yt()!==n?(o=function(){var r,t,e;if(lt++,r=at,t=[],(e=Nt())!==n)for(;e!==n;)t.push(e),e=Nt();else t=n;t!==n&&(ut=r,t=re(t.join("")));lt--,(r=t)===n&&(t=n,0===lt&&At(Gr));return r}(),o!==n&&Yt()!==n?(ut=t,i=o,t={subquestion:{format:null!==(c=a)?c.format:te(),text:null!==c?c.text:""},subanswer:i}):(at=t,t=n)):(at=t,t=n)):(at=t,t=n)):(at=t,t=n)):(at=t,t=n),lt--,t===n&&(n,0===lt&&At(A)),t}function Ft(){var t,e,a,u,o,c,i,l,s,f,h;return lt++,t=at,Yt()!==n?(e=at,j.test(r.charAt(at))?(a=r.charAt(at),at++):(a=n,0===lt&&At(M)),a!==n&&(u=Yt())!==n?((o=wt())===n&&(o=null),o!==n&&(c=Yt())!==n&&(i=Pt())!==n?e=a=[a,u,o,c,i]:(at=e,e=n)):(at=e,e=n),e!==n?((a=Et())===n&&(a=null),a!==n&&(u=Yt())!==n?(ut=t,s=a,f=(l=e)[2],h=l[4],t={isCorrect:"="==l[0],weight:f,text:h,feedback:s}):(at=t,t=n)):(at=t,t=n)):(at=t,t=n),lt--,t===n&&(n,0===lt&&At($)),t}function wt(){var t,e,a,u,o;return lt++,t=at,37===r.charCodeAt(at)?(e="%",at++):(e=n,0===lt&&At(N)),e!==n?(a=at,_.test(r.charAt(at))?(u=r.charAt(at),at++):(u=n,0===lt&&At(L)),u===n&&(u=null),u!==n?(o=function(){var t,e,a,u,o,c;lt++,r.substr(at,3)===q?(t=q,at+=3):(t=n,0===lt&&At(G));if(t===n)if(t=at,O.test(r.charAt(at))?(e=r.charAt(at),at++):(e=n,0===lt&&At(P)),e!==n)if(O.test(r.charAt(at))?(a=r.charAt(at),at++):(a=n,0===lt&&At(P)),a===n&&(a=null),a!==n)if(D.test(r.charAt(at))?(u=r.charAt(at),at++):(u=n,0===lt&&At(Q)),u===n&&(u=null),u!==n){for(o=[],O.test(r.charAt(at))?(c=r.charAt(at),at++):(c=n,0===lt&&At(P));c!==n;)o.push(c),O.test(r.charAt(at))?(c=r.charAt(at),at++):(c=n,0===lt&&At(P));o!==n?(ut=t,t=e=st()):(at=t,t=n)}else at=t,t=n;else at=t,t=n;else at=t,t=n;lt--,t===n&&(e=n,0===lt&&At(U));return t}(),o!==n?a=u=[u,o]:(at=a,a=n)):(at=a,a=n),a!==n?(37===r.charCodeAt(at)?(u="%",at++):(u=n,0===lt&&At(N)),u!==n?(ut=t,t=e=parseFloat(a.join(""))):(at=t,t=n)):(at=t,t=n)):(at=t,t=n),lt--,t===n&&(e=n,0===lt&&At(R)),t}function Et(){var t,e,a,u,o;return lt++,t=at,35===r.charCodeAt(at)?(e=H,at++):(e=n,0===lt&&At(I)),e!==n?(a=at,lt++,"###"===r.substr(at,3)?(u="###",at+=3):(u=n,0===lt&&At(z)),lt--,u===n?a=void 0:(at=a,a=n),a!==n&&(u=Yt())!==n?((o=Pt())===n&&(o=null),o!==n?(ut=t,t=e=o):(at=t,t=n)):(at=t,t=n)):(at=t,t=n),lt--,t===n&&(e=n,0===lt&&At(Y)),t}function kt(){var t,e,a,u,o,c,i,l,s,f;return lt++,t=at,Yt()!==n?(e=at,j.test(r.charAt(at))?(a=r.charAt(at),at++):(a=n,0===lt&&At(M)),a!==n?((u=wt())===n&&(u=null),u!==n?((o=St())===n&&(o=null),o!==n?e=a=[a,u,o]:(at=e,e=n)):(at=e,e=n)):(at=e,e=n),e!==n&&(a=Yt())!==n?((u=Et())===n&&(u=null),u!==n&&(o=Yt())!==n?(ut=t,i=u,l=(c=e)[0],s=c[1],f=c[2],t={isCorrect:"="==l,weight:s,text:null!==f?f:{format:te(),text:"*"},feedback:i}):(at=t,t=n)):(at=t,t=n)):(at=t,t=n),lt--,t===n&&(n,0===lt&&At(X)),t}function St(){var t;return lt++,t=function(){var t,e,a,u;lt++,t=at,(e=Dt())!==n?(58===r.charCodeAt(at)?(a=tr,at++):(a=n,0===lt&&At(er)),a!==n&&(u=Dt())!==n?(ut=t,t=e={type:"range",number:e,range:u}):(at=t,t=n)):(at=t,t=n);lt--,t===n&&(e=n,0===lt&&At(rr));return t}(),t===n&&(t=function(){var t,e,a,u;lt++,t=at,(e=Dt())!==n?(r.substr(at,2)===ar?(a=ar,at+=2):(a=n,0===lt&&At(ur)),a!==n&&(u=Dt())!==n?(ut=t,t=e={type:"high-low",numberHigh:u,numberLow:e}):(at=t,t=n)):(at=t,t=n);lt--,t===n&&(e=n,0===lt&&At(nr));return t}(),t===n&&(t=function(){var r,t;lt++,r=at,(t=Dt())!==n&&(ut=r,t={type:"simple",number:t});lt--,(r=t)===n&&(t=n,0===lt&&At(or));return r}())),lt--,t===n&&(n,0===lt&&At(Z)),t}function Tt(){var t,e,a,u;if(lt++,t=at,r.substr(at,2)===ir?(e=ir,at+=2):(e=n,0===lt&&At(lr)),e!==n){if(a=[],(u=Rt())!==n)for(;u!==n;)a.push(u),u=Rt();else a=n;a!==n?(r.substr(at,2)===ir?(u=ir,at+=2):(u=n,0===lt&&At(lr)),u!==n?(ut=t,t=e=a.join("")):(at=t,t=n)):(at=t,t=n)}else at=t,t=n;return lt--,t===n&&(e=n,0===lt&&At(cr)),t}function $t(){var r,t;return lt++,r=at,(t=Pt())!==n&&(ut=r,t=fr(t)),lt--,(r=t)===n&&(t=n,0===lt&&At(sr)),r}function jt(){var r,t,e;return lt++,r=function(){var r,t,e,a;if(lt++,r=at,(t=Jt())!==n){if(e=[],(a=Mt())!==n)for(;a!==n;)e.push(a),a=Mt();else e=n;e!==n?r=t=[t,e]:(at=r,r=n)}else at=r,r=n;lt--,r===n&&(t=n,0===lt&&At(pr));return r}(),r===n&&(r=at,(t=Jt())===n&&(t=null),t!==n&&(e=Kt())!==n?r=t=[t,e]:(at=r,r=n)),lt--,r===n&&(t=n,0===lt&&At(hr)),r}function Mt(){var r,t,e;for(lt++,r=at,t=[],e=Bt();e!==n;)t.push(e),e=Bt();return t!==n&&(e=Jt())!==n?r=t=[t,e]:(at=r,r=n),lt--,r===n&&(t=n,0===lt&&At(dr)),r}function Rt(){var t,e,a;return lt++,t=at,e=at,lt++,r.substr(at,2)===ir?(a=ir,at+=2):(a=n,0===lt&&At(lr)),lt--,a===n?e=void 0:(at=e,e=n),e!==n?((a=qt())===n&&(a=Gt()),a!==n?(ut=t,t=e=a):(at=t,t=n)):(at=t,t=n),lt--,t===n&&(e=n,0===lt&&At(gr)),t}function Nt(){var r;return lt++,(r=Gt())===n&&(r=qt())===n&&(r=Ut()),lt--,r===n&&(n,0===lt&&At(Ar)),r}function _t(){var t;return lt++,t=function(){var t,e,a;lt++,t=at,e=at,lt++,(a=qt())===n&&(a=Ot())===n&&(r.substr(at,2)===m?(a=m,at+=2):(a=n,0===lt&&At(b)),a===n&&(a=jt()));lt--,a===n?e=void 0:(at=e,e=n);e!==n?(r.length>at?(a=r.charAt(at),at++):(a=n,0===lt&&At(Nr)),a!==n?(ut=t,t=e=_r()):(at=t,t=n)):(at=t,t=n);lt--,t===n&&(e=n,0===lt&&At(Rr));return t}(),t===n&&(t=qt())===n&&(t=Ut()),lt--,t===n&&(n,0===lt&&At(Ar)),t}function Lt(){var t,e,a,u;return lt++,t=at,91===r.charCodeAt(at)?(e="[",at++):(e=n,0===lt&&At(mr)),e!==n?(r.substr(at,4)===br?(a=br,at+=4):(a=n,0===lt&&At(Cr)),a===n&&(r.substr(at,8)===xr?(a=xr,at+=8):(a=n,0===lt&&At(yr)),a===n&&(r.substr(at,5)===Fr?(a=Fr,at+=5):(a=n,0===lt&&At(wr)),a===n&&(r.substr(at,6)===Er?(a=Er,at+=6):(a=n,0===lt&&At(kr))))),a!==n?(93===r.charCodeAt(at)?(u="]",at++):(u=n,0===lt&&At(Sr)),u!==n?(ut=t,t=e=a):(at=t,t=n)):(at=t,t=n)):(at=t,t=n),lt--,t===n&&(e=n,0===lt&&At(vr)),t}function Ut(){var t;return lt++,92===r.charCodeAt(at)?(t="\\",at++):(t=n,0===lt&&At($r)),lt--,t===n&&(n,0===lt&&At(Tr)),t}function qt(){var t,e;return lt++,t=at,Ut()!==n?((e=Ut())===n&&(58===r.charCodeAt(at)?(e=tr,at++):(e=n,0===lt&&At(er)),e===n&&(126===r.charCodeAt(at)?(e="~",at++):(e=n,0===lt&&At(Mr)),e===n&&(61===r.charCodeAt(at)?(e="=",at++):(e=n,0===lt&&At(v)),e===n&&(35===r.charCodeAt(at)?(e=H,at++):(e=n,0===lt&&At(I)),e===n&&(91===r.charCodeAt(at)?(e="[",at++):(e=n,0===lt&&At(mr)),e===n&&(93===r.charCodeAt(at)?(e="]",at++):(e=n,0===lt&&At(Sr)),e===n&&(123===r.charCodeAt(at)?(e="{",at++):(e=n,0===lt&&At(f)),e===n&&(125===r.charCodeAt(at)?(e="}",at++):(e=n,0===lt&&At(h)))))))))),e!==n?(ut=t,t=e):(at=t,t=n)):(at=t,t=n),lt--,t===n&&(n,0===lt&&At(jr)),t}function Gt(){var t,e,a;return lt++,t=at,e=at,lt++,(a=qt())===n&&(a=Ot())===n&&(a=jt()),lt--,a===n?e=void 0:(at=e,e=n),e!==n?(r.length>at?(a=r.charAt(at),at++):(a=n,0===lt&&At(Nr)),a!==n?(ut=t,t=e=_r()):(at=t,t=n)):(at=t,t=n),lt--,t===n&&(e=n,0===lt&&At(Rr)),t}function Ot(){var t;return 61===r.charCodeAt(at)?(t="=",at++):(t=n,0===lt&&At(v)),t===n&&(126===r.charCodeAt(at)?(t="~",at++):(t=n,0===lt&&At(Mr)),t===n&&(35===r.charCodeAt(at)?(t=H,at++):(t=n,0===lt&&At(I)),t===n&&(123===r.charCodeAt(at)?(t="{",at++):(t=n,0===lt&&At(f)),t===n&&(125===r.charCodeAt(at)?(t="}",at++):(t=n,0===lt&&At(h)),t===n&&(92===r.charCodeAt(at)?(t="\\",at++):(t=n,0===lt&&At($r)),t===n&&(58===r.charCodeAt(at)?(t=tr,at++):(t=n,0===lt&&At(er)))))))),t}function Pt(){var r,t,e,a;if(lt++,r=at,(t=Lt())===n&&(t=null),t!==n)if(Yt()!==n){if(e=[],(a=Nt())!==n)for(;a!==n;)e.push(a),a=Nt();else e=n;e!==n?(ut=r,r=t=Ur(t,e)):(at=r,r=n)}else at=r,r=n;else at=r,r=n;return lt--,r===n&&(t=n,0===lt&&At(qr)),r}function Dt(){var t,e,a,u;if(t=at,e=[],O.test(r.charAt(at))?(a=r.charAt(at),at++):(a=n,0===lt&&At(P)),a!==n)for(;a!==n;)e.push(a),O.test(r.charAt(at))?(a=r.charAt(at),at++):(a=n,0===lt&&At(P));else e=n;return e!==n?(a=function(){var t,e,a,u,o;t=at,46===r.charCodeAt(at)?(e=Pr,at++):(e=n,0===lt&&At(Dr));if(e!==n)if(a=at,lt++,46===r.charCodeAt(at)?(u=Pr,at++):(u=n,0===lt&&At(Dr)),lt--,u===n?a=void 0:(at=a,a=n),a!==n){for(u=[],O.test(r.charAt(at))?(o=r.charAt(at),at++):(o=n,0===lt&&At(P));o!==n;)u.push(o),O.test(r.charAt(at))?(o=r.charAt(at),at++):(o=n,0===lt&&At(P));u!==n?(ut=t,t=e="."+u.join("")):(at=t,t=n)}else at=t,t=n;else at=t,t=n;return t}(),a===n&&(a=null),a!==n?(ut=t,u=a,t=e=parseFloat(e.join("")+u)):(at=t,t=n)):(at=t,t=n),t}function Qt(){var t,e,a;return t=at,r.substr(at,4)===Qr?(e=Qr,at+=4):(e=n,0===lt&&At(Yr)),e!==n&&Yt()!==n&&(a=Pt())!==n&&Yt()!==n?(ut=t,t=e=a):(at=t,t=n),t}function Yt(){var r,t,e,a,u;for(lt++,r=[],(t=Bt())===n&&(t=at,(e=Jt())!==n?(a=at,lt++,u=Mt(),lt--,u===n?a=void 0:(at=a,a=n),a!==n?t=e=[e,a]:(at=t,t=n)):(at=t,t=n));t!==n;)r.push(t),(t=Bt())===n&&(t=at,(e=Jt())!==n?(a=at,lt++,u=Mt(),lt--,u===n?a=void 0:(at=a,a=n),a!==n?t=e=[e,a]:(at=t,t=n)):(at=t,t=n));return lt--,r===n&&(t=n,0===lt&&At(Hr)),r}function Ht(){var r,t;for(lt++,r=[],(t=zt())===n&&(t=Jt())===n&&(t=Bt());t!==n;)r.push(t),(t=zt())===n&&(t=Jt())===n&&(t=Bt());return lt--,r===n&&(t=n,0===lt&&At(Ir)),r}function It(){var t,e,a,u;for(t=at,e=at,lt++,a=[],32===r.charCodeAt(at)?(u=" ",at++):(u=n,0===lt&&At(zr));u!==n;)a.push(u),32===r.charCodeAt(at)?(u=" ",at++):(u=n,0===lt&&At(zr));return lt--,a!==n?(at=e,e=void 0):e=n,e!==n&&(ut=t,Vt=null,e=void(Wt=null)),t=e}function zt(){var t,e,a,u,o,c;if(lt++,t=at,r.substr(at,2)===Jr?(e=Jr,at+=2):(e=n,0===lt&&At(Kr)),e!==n){for(a=[],Vr.test(r.charAt(at))?(u=r.charAt(at),at++):(u=n,0===lt&&At(Wr));u!==n;)a.push(u),Vr.test(r.charAt(at))?(u=r.charAt(at),at++):(u=n,0===lt&&At(Wr));a!==n?(ut=t,o=a.join(""),(c=o.match(/\[id:([^\x00-\x1F\x7F]+?)]/))&&(Vt=c[1].trim().replace("\\]","]")),o.matchAll(/\[tag:([^\x00-\x1F\x7F]+?)]/g),Array.from(o.matchAll(/\[tag:([^\x00-\x1F\x7F]+?)]/g),(function(r){return r[1]})).forEach((function(r){Wt||(Wt=[]),Wt.push(r)})),t=e=null):(at=t,t=n)}else at=t,t=n;return lt--,t===n&&(e=n,0===lt&&At(Br)),t}function Bt(){var t;return lt++,32===r.charCodeAt(at)?(t=" ",at++):(t=n,0===lt&&At(zr)),t===n&&(9===r.charCodeAt(at)?(t="\t",at++):(t=n,0===lt&&At(Zr))),lt--,t===n&&(n,0===lt&&At(Xr)),t}function Jt(){var t;return lt++,"\r\n"===r.substr(at,2)?(t="\r\n",at+=2):(t=n,0===lt&&At(tt)),t===n&&(10===r.charCodeAt(at)?(t="\n",at++):(t=n,0===lt&&At(et)),t===n&&(13===r.charCodeAt(at)?(t="\r",at++):(t=n,0===lt&&At(nt)))),lt--,t===n&&(n,0===lt&&At(rt)),t}function Kt(){var t,e,a;return t=at,e=at,lt++,r.length>at?(a=r.charAt(at),at++):(a=n,0===lt&&At(Nr)),lt--,a===n?e=void 0:(at=e,e=n),e!==n&&(ut=t,e="EOF"),t=e}var Vt=null,Wt=null,Xt="moodle",Zt=Xt;function re(r){return void 0!==t&&"noTrim"in t||r.trim(),(r=r.replace(/[\n\r]/g," ")).replace(/\s\s+/g," ")}function te(){return Zt}function ee(){Zt=Xt}if((e=u())!==n&&at===r.length)return e;throw e!==n&&at<r.length&&At({type:"end"}),vt(it,ct<r.length?r.charAt(ct):null,ct<r.length?gt(ct,ct+1):gt(ct,ct))}peg$subclass(peg$SyntaxError,Error),peg$SyntaxError.buildMessage=function(r,t){var e={literal:function(r){return'"'+a(r.text)+'"'},class:function(r){var t,e="";for(t=0;t<r.parts.length;t++)e+=r.parts[t]instanceof Array?u(r.parts[t][0])+"-"+u(r.parts[t][1]):u(r.parts[t]);return"["+(r.inverted?"^":"")+e+"]"},any:function(r){return"any character"},end:function(r){return"end of input"},other:function(r){return r.description}};function n(r){return r.charCodeAt(0).toString(16).toUpperCase()}function a(r){return r.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+n(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+n(r)}))}function u(r){return r.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+n(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+n(r)}))}return"Expected "+function(r){var t,n,a,u=new Array(r.length);for(t=0;t<r.length;t++)u[t]=(a=r[t],e[a.type](a));if(u.sort(),u.length>0){for(t=1,n=1;t<u.length;t++)u[t-1]!==u[t]&&(u[n]=u[t],n++);u.length=n}switch(u.length){case 1:return u[0];case 2:return u[0]+" or "+u[1];default:return u.slice(0,-1).join(", ")+", or "+u[u.length-1]}}(r)+" but "+function(r){return r?'"'+a(r)+'"':"end of input"}(t)+" found."},module.exports={SyntaxError:peg$SyntaxError,parse:peg$parse};
